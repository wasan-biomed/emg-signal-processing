#  ูุดุฑูุน MATLAB: ูุนุงูุฌุฉ ูุชุตููู ูุชุญูู ุจุฅุดุงุฑุฉ ุงูุนุถูุงุช (EMG)

**ุงููุคููุฉ: ุงููููุฏุณุฉ ูุณู ูุตู ุญุณู**  
๐ [๐ฌ๐ง ุงูุฅูุฌููุฒูุฉ](README.md) | [๐ธ๐ฆ ุงูุนุฑุจูุฉ](README_AR.md) | [๐ฉ๐ช ุงูุฃููุงููุฉ](README_DE.md)

---

##  ููุฑุฉ ุงููุดุฑูุน:

ูุนุฑุถ ูุฐุง ุงููุดุฑูุน ุฎุทูุงุช ูุนุงูุฌุฉ ูุชุญููู ูุงูุชุญูู ูู ุฅุดุงุฑุงุช ุงูุนุถูุงุช ุงูููุฑุจุงุฆูุฉ (EMG) ุจุงุณุชุฎุฏุงู MATLAB.

ููุชุถูู ุซูุงุซ ูุฑุงุญู ุฑุฆูุณูุฉ:

1. **ููุชุฑุฉ ุฅุดุงุฑุฉ EMG** ูุฅุฒุงูุฉ ุงูุถูุถุงุก.  
2. **ุงุณุชุฎูุงุต ุงูุฎุตุงุฆุต ูุชุดุฎูุต ุงูุญุงูุงุช ุงูุนุถููุฉ.**  
3. **ุงูุชุญูู ุงูุตูุฑู ุจูุงุกู ุนูู ุงููุดุงุท ุงูุนุถูู (ุนุฑุถ ุตูุฑุฉ ุงููุฏ ููุชูุญุฉ ุฃู ูุบููุฉ).**

> โ ุงูุฅุดุงุฑุงุช ุงููุณุชุฎุฏูุฉ ููุง **ููููุฏุฉ ูุฏูููุง ุฏุงุฎู MATLAB** ูููุณุช ุญููููุฉ ูู ุฃุฌูุฒุฉ ุงุณุชุดุนุงุฑ.

---

##  ุงููุฑุญูุฉ 1: ุชูููุฏ ูููุชุฑุฉ ุฅุดุงุฑุฉ EMG

###  ุงููุฏู:

* ูุญุงูุงุฉ ุฅุดุงุฑุฉ ุนุถููุฉ ุชุญุชูู ุนูู ุชุฑุฏุฏุงุช ูู ูุทุงู 20โ450 ูุฑุชุฒ.  
* ุชูุฑูุฑ ุงูุฅุดุงุฑุฉ ุฎูุงู ููุชุฑ Butterworth ูุทุงู ุชูุฑูุฑ (Bandpass).

###  ููุฏ MATLAB:

```matlab
Fs = 1000; % ุงูุชุฑุฏุฏ ุงูุนููุงุชู
t = 0:1/Fs:5; % ูุฏุฉ 5 ุซูุงูู

% ุชูููุฏ ุฅุดุงุฑุฉ EMG ุงุตุทูุงุนูุฉ
emg_clean = 0.5 * sin(2*pi*60*t) + 0.3 * sin(2*pi*150*t);
noise = 0.2 * randn(size(t));
emg_raw = emg_clean + noise;

% ุฑุณู ุงูุฅุดุงุฑุฉ ูุจู ุงูููุชุฑุฉ
figure;
plot(t, emg_raw);
title('ุฅุดุงุฑุฉ EMG ุงูุฎุงู');
xlabel('ุงูุฒูู (ุซุงููุฉ)'); ylabel('ุงูุณุนุฉ');

% ุชุทุจูู ููุชุฑ ุชูุฑูุฑ ูุทุงู 20โ450 ูุฑุชุฒ
[b, a] = butter(4, [20 450]/(Fs/2), 'bandpass');
emg_filtered = filtfilt(b, a, emg_raw);

% ุฑุณู ุงูุฅุดุงุฑุฉ ุจุนุฏ ุงูููุชุฑุฉ
figure;
plot(t, emg_filtered);
title('ุฅุดุงุฑุฉ EMG ุจุนุฏ ุงูููุชุฑุฉ');
xlabel('ุงูุฒูู (ุซุงููุฉ)'); ylabel('ุงูุณุนุฉ');
```

---

##  ุงููุฑุญูุฉ 2: ุงูุชุตููู (ุงูุชุดุฎูุต)

###  ุงููุฏู:

ุงุณุชุฎูุงุต ุฎุตุงุฆุต ุฑูููุฉ ูู ุงูุฅุดุงุฑุฉ ุงููููุชุฑุฉ ูุชุตููููุง ุฅูู ุฅุญุฏู ุงูุญุงูุงุช ุงูุชุงููุฉ:

- **ุนุถูุงุช ุณูููุฉ (Healthy)**  
- **ุงุนุชูุงู ุนุถูู (Myopathy)**  
- **ุงุนุชูุงู ุนุตุจู (Neuropathy)**

### ุงูุฎุตุงุฆุต ุงููุณุชุฎุฑุฌุฉ:

- **RMS** ุงูุฌุฐุฑ ุงูุชุฑุจูุนู ูููููุฉ ุงููุชูุณุทุฉ  
- **MAV** ูุชูุณุท ุงููููุฉ ุงููุทููุฉ  
- **WL** ุทูู ุดูู ุงูููุฌุฉ

###  ููุฏ ุงุณุชุฎุฑุงุฌ ุงูุฎุตุงุฆุต:

```matlab
window_size = 200;
num_windows = floor(length(emg_filtered)/window_size);
RMS = zeros(1, num_windows);
MAV = zeros(1, num_windows);
WL = zeros(1, num_windows);

for i = 1:num_windows
    segment = emg_filtered((i-1)*window_size + 1 : i*window_size);
    RMS(i) = sqrt(mean(segment.^2));
    MAV(i) = mean(abs(segment));
    WL(i) = sum(abs(diff(segment)));
end

time_axis = (0:num_windows-1) * (window_size / Fs);

figure;
plot(time_axis, RMS, 'r'); hold on;
plot(time_axis, MAV, 'g');
plot(time_axis, WL, 'b');
legend('RMS', 'MAV', 'WL');
title('ุงูุฎุตุงุฆุต ุงููุณุชุฎุฑุฌุฉ ูู EMG');
xlabel('ุงูุฒูู (ุซุงููุฉ)'); ylabel('ูููุฉ ุงูุฎุงุตูุฉ');
```

---

###  ููุฏ ุงูุชุตููู ูุงููุญุงูุงุฉ:

```matlab
Fs = 1000;
t = 0:1/Fs:5;

emg_healthy = 0.5*sin(2*pi*60*t) + 0.3*sin(2*pi*120*t) + 0.2*randn(size(t));
emg_myopathy = 0.2*sin(2*pi*60*t) + 0.1*sin(2*pi*120*t) + 0.2*randn(size(t));
emg_neuropathy = 0.8*sin(2*pi*40*t) + 0.6*sin(2*pi*90*t) + 0.5*rand(size(t));

signals = {emg_healthy, emg_myopathy, emg_neuropathy};
labels = {'Healthy', 'Myopathy', 'Neuropathy'};

features = [];
class_labels = [];

for idx = 1:length(signals)
    signal = signals{idx};
    for i = 1:floor(length(signal)/window_size)
        segment = signal((i-1)*window_size + 1 : i*window_size);
        RMS = sqrt(mean(segment.^2));
        MAV = mean(abs(segment));
        WL = sum(abs(diff(segment)));
        features = [features; RMS, MAV, WL];
        class_labels = [class_labels; idx];
    end
end

% ุชุฏุฑูุจ ุงููุตูู
X = features; Y = class_labels;
model = fitcecoc(X, Y);

% ุงุฎุชุจุงุฑ ุชูุจุค ุณุฑูุน
predicted = predict(model, X(1:5,:));
disp('ุงูุชุณููุงุช ุงููุชููุนุฉ ูุฃูู 5 ููุงูุฐ:');
disp(predicted);
```

---

##  ุงููุฑุญูุฉ 3: ุงูุชุญูู ุงูุจุตุฑู ุงุนุชูุงุฏูุง ุนูู ุงูุนุถูุงุช

###  ุงููุฏู:

ุนุฑุถ ุตูุฑุฉ ุงููุฏ ููุชูุญุฉ ุฃู ูุบููุฉ ุญุณุจ ูููุฉ MAV ููู ููุทุน ูู ุงูุฅุดุงุฑุฉ.

###  ุงูุตูุฑ ุงููุทููุจุฉ:

- `hand_open.png` โ ูุฏ ููุชูุญุฉ  
- `hand_closed.png` โ ูุฏ ูุบููุฉ  

> ุถูุน ูุฐู ุงูุตูุฑ ูู ููุณ ูุฌูุฏ ุงูุณูุฑุจุช.

###  ููุฏ ุงูุชุญูู:

```matlab
Fs = 1000;
t = 0:1/Fs:5;
emg_signal = 0.5*sin(2*pi*70*t) + 0.3*sin(2*pi*140*t) + 0.2*randn(size(t));
window_size = 200;
num_windows = floor(length(emg_signal)/window_size);
threshold = 0.25;

figure;
for i = 1:num_windows
    segment = emg_signal((i-1)*window_size + 1 : i*window_size);
    MAV = mean(abs(segment));

    if MAV > threshold
        img = imread('hand_open.png');
        title_txt = '๐ ุนุถูุฉ ูุดุทุฉ โ ูุฏ ููุชูุญุฉ';
    else
        img = imread('hand_closed.png');
        title_txt = '๐ ุนุถูุฉ ุบูุฑ ูุดุทุฉ โ ูุฏ ูุบููุฉ';
    end

    imshow(img);
    title(title_txt, 'FontSize', 14);
    pause(0.1);
end
```

---

##  ุงูููุฎุต:

-  ุชู ุชูููุฏ ุฅุดุงุฑุฉ EMG ูุฏูููุง ุจุงุณุชุฎุฏุงู `sin` ู `randn` ูู MATLAB.  
-  ุชู ููุชุฑุชูุง ุจุงุณุชุฎุฏุงู ููุชุฑ ุชูุฑูุฑ ูุทุงู 20โ450 ูุฑุชุฒ.  
-  ุชู ุงุณุชุฎุฑุงุฌ ุงูุฎุตุงุฆุต (RMSุ MAVุ WL) ูุงุณุชุฎุฏุงููุง ูุชุตููู ุงูุญุงูุงุช.  
-  ุชู ุจูุงุก ูุธุงู ุชุญูู ุจุตุฑู ุจุณูุท ูุบูุฑ ุงูุตูุฑ ุญุณุจ ูุดุงุท ุงูุนุถูุฉ.

>  **ูุฐุง ุงููุดุฑูุน ุชู ุชูููุฐู ูุชูุซููู ุจุงููุงูู ูู ูุจู ุงููููุฏุณุฉ ุงูุทุจูุฉ ูุณู ูุตู ุญุณู ุจุงุณุชุฎุฏุงู MATLAB Online.**  
> ููุนุฏ ูุฐุง ุงููุดุฑูุน ุฃุณุงุณูุง ูุชุทููุฑุงุช ูุงุญูุฉ ูุซู (ูุงุฌูุฉ ุฑุณูููุฉุ ุงูุนูู ุจุงูุฒูู ุงูุญููููุ ุฑุจุท ูุน Arduino) ุฃู ูุฃุฏุงุฉ ุชุนููููุฉ ููุดุฑูุน ุชุฎุฑุฌ ุฃู ุชุฏุฑูุจ.
